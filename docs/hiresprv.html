
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Python API &#8212; HIRES PRV  documentation</title>
    <link rel="stylesheet" href="_static/graphite.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Velocity Precision" href="performance.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="performance.html" title="Velocity Precision"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HIRES PRV  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h1>
<p>These modules are arranged here in roughly the order they are normally used.
For instance, the first step always has to be a KOA login.</p>
<span class="target" id="module-hiresprv"></span><p>The HIRES PRV pipeline is used to retrieve user-specified radial velocity
data from the KOA archive to a user-specific pipeline server workspace,
automatically perform raw data reduction (converting the 2D spectral files
to 1D spectra) and then run user-defined reduction scripts to ultimately
generate RV curves for specific sky objects.</p>
<p>The data is retrieved a day at a time (a full night’s data is needed for
the raw reduction).  Metadata for all the files retrieved is stored in a
workspace/user-specific database table, which is user-searchable and
provides the information needed to construct reduction scripts.</p>
<p>Both the archive retrieval and reduction steps can be quite lengthy
(often hours), so this is done in background and there are tools for
monitoring the state of the processing.</p>
<div class="section" id="module-hiresprv.auth">
<span id="authentication"></span><h2>Authentication<a class="headerlink" href="#module-hiresprv.auth" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">hiresprv.login</span></code> module initializes an account on the PRV pipeline
server for reduction of radial velocity data.</p>
<dl class="function">
<dt id="hiresprv.auth.login">
<code class="sig-prename descclassname">hiresprv.auth.</code><code class="sig-name descname">login</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/auth.html#login"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.auth.login" title="Permalink to this definition">¶</a></dt>
<dd><p>The login function prompts for an authorized KOA user ID and password,
then sets up a workspace (or connects to an existing workspace) on
the PRV pipeline server for that user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cookiepath</strong> (<em>string</em>) – a file path provided by the user to save
returned cookie which is needed for the
subsequent PRV operations.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hiresprv.auth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hiresprv</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">cookiepath</span><span class="p">)</span>
<span class="go"># program will prompt for userid and password</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-hiresprv.archive">
<span id="data-transfer-and-reduction"></span><h2>Data Transfer and Reduction<a class="headerlink" href="#module-hiresprv.archive" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">hiresprv.archive</span></code> module handles data transfers from the Keck Observatory Archive (KOA) archive into the
user workspace on the server and the reduction from 2D CCD images to 1D spectra.</p>
<dl class="class">
<dt id="hiresprv.archive.Archive">
<em class="property">class </em><code class="sig-prename descclassname">hiresprv.archive.</code><code class="sig-name descname">Archive</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/archive.html#Archive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.archive.Archive" title="Permalink to this definition">¶</a></dt>
<dd><p>The Archive class provides KOA archive access functions for the HIRES PRV
pipeline reduction service.</p>
<p>The user’s KOA credentials (given at login) are used to search KOA for nights
containing HIRES-PRV compatible data. Matching data are copied to the user’s
workspace and raw reduction (conversion to 1D spectra, barycentric
correction, file organization, etc.) is performed.  Results are logged in the workspace
database table.  All this is done in background; the search functions
return almost immediately with an acknowledgement.</p>
<p>Because of pipeline requirements, data is always processed a full
night at a time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cookiepath</strong> – full path to a cookie file saved by <a class="reference internal" href="#hiresprv.auth.login" title="hiresprv.auth.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">hiresprv.auth.login()</span></code></a></p>
</dd>
</dl>
<dl class="method">
<dt id="hiresprv.archive.Archive.by_dates">
<code class="sig-name descname">by_dates</code><span class="sig-paren">(</span><em class="sig-param">dates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/archive.html#Archive.by_dates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.archive.Archive.by_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs and submits a URL to the server for processing</p>
<p>This method receives an acknowledgement upon successful submission
which means it has successfully authenticated the KOA user and
can start the data search, download, and reduction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dates</strong> (<em>string</em>) – a date string or multiple date strings separated by comma or newline.
Each date should be in to ‘yyyy-mm-dd’ format.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Status (‘ok’ or ‘error’) and a message string</p>
<p>”{status’:’ok’, ‘msg’:’Processing dates in background.’}” if successful</p>
<p>”{‘status’:’error’, ‘msg’:’Failed to connect to KOA’}” if submission failed</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hiresprv.archive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srch</span> <span class="o">=</span> <span class="n">hiresprv</span><span class="o">.</span><span class="n">archive</span><span class="o">.</span><span class="n">Archive</span><span class="p">(</span><span class="n">cookiepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_date_string</span> <span class="o">=</span> <span class="s2">&quot;2013-09-23,2013-09-25,2013-10-01&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srch</span><span class="o">.</span><span class="n">by_dates</span><span class="p">(</span><span class="n">multi_date_string</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hiresprv.archive.Archive.by_datefile">
<code class="sig-name descname">by_datefile</code><span class="sig-paren">(</span><em class="sig-param">datefile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/archive.html#Archive.by_datefile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.archive.Archive.by_datefile" title="Permalink to this definition">¶</a></dt>
<dd><p>This method operates the same as by_dates method except it reads
the dates string from a file containing a list of dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>datefile</strong> (<em>string</em>) – Path to a file containing more than one date. Each date
sould be in the ‘yyyy-mm-dd’ format and separated by new line.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Same status and msg as <a class="reference internal" href="#hiresprv.archive.Archive.by_dates" title="hiresprv.archive.Archive.by_dates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hiresprv.archive.Archive.by_dates()</span></code></a> method</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hiresprv.status">
<span id="progress-monitor"></span><h2>Progress Monitor<a class="headerlink" href="#module-hiresprv.status" title="Permalink to this headline">¶</a></h2>
<p>Monitor the progress of active processing jobs.</p>
<dl class="class">
<dt id="hiresprv.status.Status">
<em class="property">class </em><code class="sig-prename descclassname">hiresprv.status.</code><code class="sig-name descname">Status</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV processing involves transferring and reducing a large amount of
data and can be quite lengthy.  Therefore, most of this processing is
done in background.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hiresprv.status.Status</span></code> class is used to check the state of the processing,
to watch progress, or simply to check whether the
workspace is busy.  New processing will be rejected until the
workspace is ready.</p>
<p>The PRV Status class initialization checks for the existence
of a login cookie and connects the user to their workspace.
Methods of this class return information on the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cookiepath</strong> (<em>string</em>) – full path to cookie file saved from <a class="reference internal" href="#hiresprv.auth.login" title="hiresprv.auth.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">hiresprv.auth.login()</span></code></a></p>
</dd>
</dl>
<dl class="method">
<dt id="hiresprv.status.Status.generate_link">
<code class="sig-name descname">generate_link</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.generate_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.generate_link" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns an HTML string that contains a link to start
the real-time monitor in a separate window/tab.  It is generally
used in applications like Jupyter notebook where you don’t want
the monitor embedded in the page.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>HTML fragment to be embedding in page to provide access
to real-time monitor page.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.status.Status.processing_status">
<code class="sig-name descname">processing_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.processing_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.processing_status" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns a URL to a page displaying the progress of
the current processing step.  For archive retrieval
this includes each file transfer and each raw reduction operation.
For data reduction scripts, this includes the various steps in the
IDL processing.</p>
<p>An attempt has been made to update the processing status every few
seconds to a minute but a few operations will run longer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>URL to a web page summarizing the progress of the current processing steps</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.status.Status.is_busy">
<code class="sig-name descname">is_busy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.is_busy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.is_busy" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the workspace is currently busy processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.status.Status.cancel">
<code class="sig-name descname">cancel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel the active job.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hiresprv.database">
<span id="observation-database"></span><h2>Observation Database<a class="headerlink" href="#module-hiresprv.database" title="Permalink to this headline">¶</a></h2>
<p>Access and query a user’s observation database.</p>
<dl class="class">
<dt id="hiresprv.database.Database">
<em class="property">class </em><code class="sig-prename descclassname">hiresprv.database.</code><code class="sig-name descname">Database</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database" title="Permalink to this definition">¶</a></dt>
<dd><p>Each workspace in HIRES PRV pipeline server contains a database
listing all the data retrieved from KOA for the user.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hiresprv.status.Database</span></code> class provides methods for querying that
database.  This information is primarily used to plan reduction
and analysis processing.</p>
<p>The initialization of database class loads the cookie file saved
from HIRES PRV pipelone login, parse the cookie to look up the
users workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cookiepath</strong> (<em>string</em>) – full path to a cookie file saved by <a class="reference internal" href="#hiresprv.auth.login" title="hiresprv.auth.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">hiresprv.auth.login()</span></code></a></p>
</dd>
</dl>
<dl class="method">
<dt id="hiresprv.database.Database.search">
<code class="sig-name descname">search</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.search" title="Permalink to this definition">¶</a></dt>
<dd><p>The search method is the most general mechanism for querying
a workspace database.  The user has the freedom to provide a
general SQL SELECT statement (specifying both the database columns
to be retrieved and constraints on the records returned).</p>
<p>When the sql is blank (i.e.: ‘’), the entire database will be
returned.</p>
<p>The user can also select an output format (html, csv or IPAC ASCII).</p>
<p>The output will be saved to a disk file and/or displayed in a browser
depending on the format:</p>
<p>‘cvs’ format: save to disk,
‘html’ format: save to disk and display in browser,
‘IPAC’ ASCII format: save to disk and display in browser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> (<em>string</em>) – (optional) fully qualified sql statement
if empty string or parameter not set, the whole database table will be returned.</p></li>
<li><p><strong>format</strong> (<em>string</em>) – (optional) string specifying the output format (‘html’|’csv’|’ipac’); the default is html</p></li>
<li><p><strong>filepath</strong> (<em>string</em>) – (optional) full path where the file will be saved; if not provided,
a URL string to an HTML view of the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>URL to HTML table if filepath is not specified</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.target_list">
<code class="sig-name descname">target_list</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.target_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.target_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all unique targets currently in
the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>URL to HTML table if filepath is not specified</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.target_info">
<code class="sig-name descname">target_info</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.target_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.target_info" title="Permalink to this definition">¶</a></dt>
<dd><p>This method retrieves the database records for all data pertaining to a specific
target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>string</em>) – target name</p></li>
<li><p><strong>format</strong> (<em>string</em>) – (optional) string specifying the output format (‘html’|’csv’|’ipac’); the default is html</p></li>
<li><p><strong>filepath</strong> (<em>string</em>) – (optional) full path where the file will be saved; if not provided,
a URL string to an HTML view of the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>URL to HTML table if filepath is not specified</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.sqlite">
<code class="sig-name descname">sqlite</code><span class="sig-paren">(</span><em class="sig-param">filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.sqlite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.sqlite" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads the sqlite database file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>string</em>) – path and filename to save the database file
on the disk.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.rv_observations">
<code class="sig-name descname">rv_observations</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.rv_observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.rv_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return metadata for all RV observations associated with a given target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<em>string</em>) – target name</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.to_pandas">
<em class="property">static </em><code class="sig-name descname">to_pandas</code><span class="sig-paren">(</span><em class="sig-param">url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.to_pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.to_pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert URL for HTML table into a Pandas DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>url</strong> (<em>string</em>) – database search url (produced by Database methods like <cite>search</cite> or <cite>target_info</cite>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hiresprv.idldriver">
<span id="idl-driver"></span><h2>IDL Driver<a class="headerlink" href="#module-hiresprv.idldriver" title="Permalink to this headline">¶</a></h2>
<p>Drive the underlying IDL code</p>
<dl class="class">
<dt id="hiresprv.idldriver.Idldriver">
<em class="property">class </em><code class="sig-prename descclassname">hiresprv.idldriver.</code><code class="sig-name descname">Idldriver</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/idldriver.html#Idldriver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.Idldriver" title="Permalink to this definition">¶</a></dt>
<dd><p>The principle processing of the HIRES PRV pipeline is done by a
set of IDL scripts developed over several decades.  This processing
is quite intensive, takes a long time, and is run in the
background.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hiresprv.idldriver.Idldriver</span></code> class provides functionality that allows
the user to submit reduction scripts that
are parsed and sent to the appropriate IDL functions on the server.</p>
<p>The idldriver class intialization checks for cookie indicating
a previous login that connects to the user to a PRV pipeline
workspace.  This workspace is populated with data from the KOA
Archive using the <a class="reference internal" href="#hiresprv.archive.Archive" title="hiresprv.archive.Archive"><code class="xref py py-class docutils literal notranslate"><span class="pre">hiresprv.archive.Archive</span></code></a> class methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cookiepath</strong> – a full path to cookie file saved from <a class="reference internal" href="#hiresprv.auth.login" title="hiresprv.auth.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">hiresprv.auth.login()</span></code></a></p>
</dd>
</dl>
<dl class="method">
<dt id="hiresprv.idldriver.Idldriver.run_script">
<code class="sig-name descname">run_script</code><span class="sig-paren">(</span><em class="sig-param">script</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/idldriver.html#Idldriver.run_script"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.Idldriver.run_script" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is given a script of steps to
run on the data in the user’s workspace.  These steps include creating
a template spectrum for a sky target, reducing specific radial
velocity measurement(s) using such a template, and creating an RV curve
from a set of reduced RV measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>script</strong> (<em>string</em>) – script containing processing steps separated by newlines</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hiresprv.idldriver</span> <span class="k">import</span> <span class="n">Idldriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idl</span> <span class="o">=</span> <span class="n">Idldriver</span><span class="p">(</span><span class="s1">&#39;prv.cookies&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rtn</span> <span class="o">=</span> <span class="n">idl</span><span class="o">.</span><span class="n">run_script</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="go">template 185144 20091231</span>
<span class="go">rv 185144 r20091231.72</span>
<span class="go">rv 185144 r20091231.73</span>
<span class="go">rv 185144 r20091231.74</span>
<span class="go">rv 185144 r20150606.145</span>
<span class="go">rv 185144 r20150606.146</span>
<span class="go">rv 185144 r20150606.147</span>
<span class="go">rvcurve 185144&quot;&quot;&quot;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>List of available commands for <cite>run_script</cite>:</p>
<p>‘template &lt;object&gt; &lt;date&gt;’ (create template)</p>
<p>‘rv &lt;obsid&gt; (calculate RV for single observation)’</p>
<p>‘rvcurve &lt;object&gt; (construct RV timeseries for an object)’</p>
<p>‘activate &lt;filename&gt; (activate or include file in analysis)’</p>
<p>‘deactivate &lt;filename&gt; (deactivate or exclude file from analysis)’</p>
</div>
</dd></dl>

<dl class="method">
<dt id="hiresprv.idldriver.Idldriver.run_scriptfile">
<code class="sig-name descname">run_scriptfile</code><span class="sig-paren">(</span><em class="sig-param">scriptfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/idldriver.html#Idldriver.run_scriptfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.Idldriver.run_scriptfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#hiresprv.idldriver.Idldriver.run_script" title="hiresprv.idldriver.Idldriver.run_script"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hiresprv.idldriver.Idldriver.run_script()</span></code></a> except takes a path to a file
containing the script lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scriptfile</strong> (<em>string</em>) – path to plain text file that will be read as a continuous string
and used as input to the <a class="reference internal" href="#hiresprv.idldriver.Idldriver.run_script" title="hiresprv.idldriver.Idldriver.run_script"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hiresprv.idldriver.Idldriver.run_script()</span></code></a> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.idldriver.Idldriver.create_rvscript">
<em class="property">static </em><code class="sig-name descname">create_rvscript</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">db</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/idldriver.html#Idldriver.create_rvscript"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.Idldriver.create_rvscript" title="Permalink to this definition">¶</a></dt>
<dd><p>Create script to prcess all RV files associated with a given target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>string</em>) – target string</p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="#hiresprv.database.Database" title="hiresprv.database.Database"><em>hiresprv.database.Database</em></a>) – Database object from your workspace</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hiresprv.download">
<span id="retrieve-results"></span><h2>Retrieve Results<a class="headerlink" href="#module-hiresprv.download" title="Permalink to this headline">¶</a></h2>
<p>Download data from the remote workspace</p>
<dl class="class">
<dt id="hiresprv.download.Download">
<em class="property">class </em><code class="sig-prename descclassname">hiresprv.download.</code><code class="sig-name descname">Download</code><span class="sig-paren">(</span><em class="sig-param">cookiepath</em>, <em class="sig-param">localdir</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/download.html#Download"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.download.Download" title="Permalink to this definition">¶</a></dt>
<dd><p>The Download class provides methods for users to download
individual files from their workspace in HIRES PRV pipeline server.</p>
<p>It validates user information (via cookie file), then contacts PRV
Server to retrieve the requested file.</p>
<p>The initialization of database class loads the cookie file saved
from HIRES PRV pipeline login, parse the cookie to look up the
users workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cookiepath</strong> (<em>string</em>) – a full cookie file path saved from auth.Login.</p></li>
<li><p><strong>localdir</strong> (<em>string</em>) – local output directory</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="hiresprv.download.Download.directory_listing">
<code class="sig-name descname">directory_listing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/download.html#Download.directory_listing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.download.Download.directory_listing" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns a listing of all the downloadable files in the
workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary with one entry for each workspace data
directory.  The value of each item is an array of full file paths within each directory.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.download.Download.download">
<code class="sig-name descname">download</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/download.html#Download.download"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.download.Download.download" title="Permalink to this definition">¶</a></dt>
<dd><p>This method downloads any file from the user’s workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – workspace file name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>structure indicating the status of the submission</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.download.Download.rvcurve">
<code class="sig-name descname">rvcurve</code><span class="sig-paren">(</span><em class="sig-param">objname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/download.html#Download.rvcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.download.Download.rvcurve" title="Permalink to this definition">¶</a></dt>
<dd><p>This method downloads a rvcurve csv file from the user’s
workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>objname</strong> (<em>string</em>) – object name; must match an entry in the ‘TARGET’ column of the workspace database</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>structure indicating the status of the submission</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hiresprv.download.Download.spectrum">
<code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">fileid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/download.html#Download.spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.download.Download.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>This method downloads one or more extracted spectrum FITS files
from the user’s workspace. The downloaded file will be a single FITS file
if <code class="docutils literal notranslate"><span class="pre">fileids</span></code> is a single observation code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileid</strong> (<em>string</em>) – one or more spectrum file names separated by
comma or new line; must match entries in the ‘FILENAME’ column in the workspace database</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>structure indicating the status of the submission</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON structure</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="index.html#mastertoc"><span class="std std-ref">Return Home</span></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hiresprv_logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">HIRES PRV</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Observing Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/HIRES_PRV_Service.html">Data Reduction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/Advanced_Usage.html">Advanced usage tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Output Data Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Velocity Precision</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html#rv-standard-stars">RV Standard Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html#comparison-with-california-planet-search-pipeline">Comparison with California Planet Search Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html#known-planet-recovery">Known Planet Recovery</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.auth">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.archive">Data Transfer and Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.status">Progress Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.database">Observation Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.idldriver">IDL Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hiresprv.download">Retrieve Results</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="performance.html" title="Velocity Precision"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HIRES PRV  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, CALTECH.
      Last updated on Oct 15, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>