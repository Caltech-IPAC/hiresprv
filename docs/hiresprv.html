
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>HIRES PRV Python library &#8212; HIRES PRV  documentation</title>
    <link rel="stylesheet" href="_static/graphite.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Data Reduction Overview" href="data_reduction_overview.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_reduction_overview.html" title="Data Reduction Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HIRES PRV  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hires-prv-python-library">
<h1>HIRES PRV Python library<a class="headerlink" href="#hires-prv-python-library" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>These modules are arranged here in roughly the order they are normally used.
For instance, the first step always has to be a KOA login.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span class="target" id="module-hiresprv"></span><p>The HIRES PRV pipeline is used to retrieve user-specified radial velocity 
data from the KOA archive to a user-specific pipeline server workspace, 
automatically perform raw data reduction (converting the 2D spectral files 
to 1D spectra) and then run user-defined reduction scripts to ultimately
generate RV curves for specific sky objects.</p>
<p>The data is retrieved a day at a time (a full night’s data is needed for
the raw reduction).  Metadata for all the files retrieved is stored in a
workspace/user-specific database table, which is user-searchable and 
provides the information needed to construct reduction scripts.</p>
<p>Both the archive retrieval and reduction steps can be quite length 
(often hours), so this is done in background and there are tools for
monitoring the state of the processing.</p>
<span class="target" id="module-hiresprv.auth"></span><p>The HIRES PRV login function initializes an account
on the PRV pipeline server for reduction of radial
velocity data.</p>
<dl class="function">
<dt id="hiresprv.auth.login">
<code class="descclassname">hiresprv.auth.</code><code class="descname">login</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/auth.html#login"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.auth.login" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV login function prompts for an authorized
KOA user ID and password, the sets up a workspace (or 
connects to an existing workspace) on the PRV pipeline
server for that user.</p>
</dd></dl>

<span class="target" id="module-hiresprv.archive"></span><p>KOA archive access functions for the HIRES PRV pipeline reduction service.  
After finding matching data, the files are copied to the user’s pipeline
workspace and raw data reduction is performed.  Because of pipeline requirements,
data is always processed a full night at a time.</p>
<dl class="class">
<dt id="hiresprv.archive.Archive">
<em class="property">class </em><code class="descclassname">hiresprv.archive.</code><code class="descname">Archive</code><a class="reference internal" href="_modules/hiresprv/archive.html#Archive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.archive.Archive" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV Archive class provides methods for searching the
KOA Archive for radial velocity data from the HIRES instrument.
This data is downloaded to a permanent workspace on the PRV 
pipeline machine and basic raw reduction is performed.</p>
<dl class="method">
<dt id="hiresprv.archive.Archive.search_by_dates">
<code class="descname">search_by_dates</code><span class="sig-paren">(</span><em>dates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/archive.html#Archive.search_by_dates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.archive.Archive.search_by_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Search archive by set of dates.</p>
<p>The user’s KOA credentials (given at login) are used to search the
Keck On-line Archive (KOA).  Matching data are copied to the user’s
workspace and raw reduction (conversion to 1D spectra, barycentric
correction, etc.) is performed.  Results are logged in the workspace
database table.  All this is done in background; this function 
returns almost immediately with an acknowledgement.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>dates (multi-line or comma-delimited string or array of strings) </dt>
<dd>dates for data to be processed, in YYYY-MM-DD format.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>JSON structure with status (‘ok’ or ‘error’)  and a message string
e.g., {‘status’:’error’, ‘msg’:’Failed to connect to KOA’}</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-hiresprv.status"></span><p>The HIRES PRV processing involves moving and reducing quite a lot of
data and can be quite lengthy.  Most of this processing is therefore
done in background.</p>
<p>The PRV Status class is used to check the state of the processing,
either in detail to watch progress or simply to check whether the 
workspace is ‘busy’.  New processing will be rejected until the 
workspace is ready.</p>
<dl class="class">
<dt id="hiresprv.status.Status">
<em class="property">class </em><code class="descclassname">hiresprv.status.</code><code class="descname">Status</code><a class="reference internal" href="_modules/hiresprv/status.html#Status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV Status class initialization check for the existence of a
login cookie and connects the user to their workspace.  Methods of this
class return information on the current state or can be used to cancel
processing.</p>
<dl class="method">
<dt id="hiresprv.status.Status.processing_status">
<code class="descname">processing_status</code><span class="sig-paren">(</span><em>format</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.processing_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.processing_status" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV Status class processing_status method returns a summary of
the progress of the current processing step.  For archive retrieval this
includes each file transfer and each raw reduction operation.  For data
reduction scripts, this includes the various steps in the IDL processing.</p>
<p>An attempt has been made to update the processing status every few 
seconds to a minute but a few operations will run longer.</p>
</dd></dl>

<dl class="method">
<dt id="hiresprv.status.Status.is_busy">
<code class="descname">is_busy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.is_busy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.is_busy" title="Permalink to this definition">¶</a></dt>
<dd><p>(TBD) Documentation on Status.is_busy</p>
</dd></dl>

<dl class="method">
<dt id="hiresprv.status.Status.cancel">
<code class="descname">cancel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/status.html#Status.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.status.Status.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>(TBD) Documentation on Status.cancel</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-hiresprv.database"></span><p>Each HIRES PRV pipeline server workspace contains a database
of all the HIRES radial velocity data retrieved from KOA for
the user.</p>
<p>The HIRES PRV Database class provides methods for querying that
database.  This information is primarily used to plan reduction
and analysis processing for specific sky targets.</p>
<dl class="class">
<dt id="hiresprv.database.Database">
<em class="property">class </em><code class="descclassname">hiresprv.database.</code><code class="descname">Database</code><a class="reference internal" href="_modules/hiresprv/database.html#Database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database" title="Permalink to this definition">¶</a></dt>
<dd><p>A HIRES PRV pipeline login creates a cookie that allows reconnection to 
a specific workspace.  Database class intialization uses that cookie to
look up the users workspace and the class methods provide various ways of
querying the data.</p>
<dl class="method">
<dt id="hiresprv.database.Database.search">
<code class="descname">search</code><span class="sig-paren">(</span><em>sql</em>, <em>format</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.search" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV Database search method is the most general mechanism for
querying a workspace database.  The user has the freedom to provide a
general SQL SELECT statement (specifying both the database columns to 
be retrieved and constraints on the records returned.  The user can
also select an output format (html, csv or IPAC ASCII).</p>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.target_list">
<code class="descname">target_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.target_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.target_list" title="Permalink to this definition">¶</a></dt>
<dd><p>(TBD) Documentation on Database.target_list</p>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.target_info">
<code class="descname">target_info</code><span class="sig-paren">(</span><em>target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.target_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.target_info" title="Permalink to this definition">¶</a></dt>
<dd><p>(TBD) Documentation on Database.target_info</p>
</dd></dl>

<dl class="method">
<dt id="hiresprv.database.Database.sqlite">
<code class="descname">sqlite</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/database.html#Database.sqlite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.database.Database.sqlite" title="Permalink to this definition">¶</a></dt>
<dd><p>(TBD) Documentation on Database.download_sqlite</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-hiresprv.idldriver"></span><p>The principle processing of the HIRES PRV pipeline is done by a
set of IDL scripts developed over several decades.  This processing
is quite intensive and takes a long time and so is run in the 
background.</p>
<p>The HIRES PRV idlDriver class provides functionality that allows
the user to submit radial velocity data reduction scripts that 
get sent to a sequence of these IDL scripts.</p>
<dl class="class">
<dt id="hiresprv.idldriver.idlDriver">
<em class="property">class </em><code class="descclassname">hiresprv.idldriver.</code><code class="descname">idlDriver</code><a class="reference internal" href="_modules/hiresprv/idldriver.html#idlDriver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.idlDriver" title="Permalink to this definition">¶</a></dt>
<dd><p>The idlDriver class intialization checks for cookie indicating a previous
login that connects to the user to a PRV pipeline workspace.  This
workspace is populated with data from the KOA Archive using Archive class
methods.</p>
<dl class="method">
<dt id="hiresprv.idldriver.idlDriver.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>script</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hiresprv/idldriver.html#idlDriver.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hiresprv.idldriver.idlDriver.run" title="Permalink to this definition">¶</a></dt>
<dd><p>The HIRES PRV idlDriver class run method is given a script of steps to
run on the data in a workspace.  These steps include creating a
template spectrum for a sky target, reducing a specific radial velocity
measurement using such a template, and creating an RV curve from a set
of reduced RV measurements.</p>
</dd></dl>

</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<p><a class="reference internal" href="index.html#mastertoc"><span class="std std-ref">Return Home</span></a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hiresprv.jpg" alt="Logo"/>
            </a></p>
<h3><a href="index.html">HIRES PRV</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="science_overview.html">Science Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_reduction_overview.html">Data Reduction Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HIRES PRV Python library</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_reduction_overview.html" title="Data Reduction Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HIRES PRV  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, CALTECH.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.7.
    </div>
  </body>
</html>